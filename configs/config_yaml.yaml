# Configuration file for chest X-ray classification

# Data paths
data:
  raw_data_dir: './NIH_ChestXray'
  processed_data_dir: './processed_data'
  image_size: 512
  
# Dataset
dataset:
  num_classes: 14
  disease_classes:
    - 'Atelectasis'
    - 'Cardiomegaly'
    - 'Effusion'
    - 'Infiltration'
    - 'Mass'
    - 'Nodule'
    - 'Pneumonia'
    - 'Pneumothorax'
    - 'Consolidation'
    - 'Edema'
    - 'Emphysema'
    - 'Fibrosis'
    - 'Pleural_Thickening'
    - 'Hernia'
  
  # Stratified sampling configuration
  samples_per_disease:
    'No Finding': 2100
    'Infiltration': 2200
    'Effusion': 1800
    'Atelectasis': 1600
    'Nodule': 1200
    'Mass': 1000
    'Pneumothorax': 950
    'Consolidation': 850
    'Pleural_Thickening': 800
    'Cardiomegaly': 750
    'Emphysema': 700
    'Edema': 650
    'Fibrosis': 600
    'Pneumonia': 550
    'Hernia': 200
  
  # Train/val/test split
  train_ratio: 0.7
  val_ratio: 0.1
  test_ratio: 0.2

# Training
training:
  # Model selection
  model_name: 'resnet50'  # Options: resnet50, densenet121, hybrid_full, hybrid_simple
  
  # Hyperparameters
  batch_size: 16
  num_epochs: 100
  learning_rate: 1.0e-4
  weight_decay: 1.0e-4
  dropout: 0.3
  
  # Optimizer
  optimizer: 'adamw'
  
  # Learning rate schedule
  use_warmup: true
  warmup_epochs: 5
  scheduler: 'cosine'  # Options: cosine, step, plateau
  
  # Regularization
  gradient_clip: 1.0
  
  # Data augmentation
  augmentation:
    horizontal_flip: 0.5
    rotation_degrees: 15
    brightness: 0.2
    contrast: 0.2
    use_clahe: true
  
  # Early stopping
  early_stopping:
    patience: 15
    monitor: 'val_auroc'
    mode: 'max'
  
  # Loss function
  loss:
    type: 'combined'  # Options: bce, weighted_bce, focal, combined
    use_focal: true
    focal_alpha: 0.25
    focal_gamma: 2.0
    lambda_focal: 0.5
    use_correlation: true
    lambda_corr: 0.1
    correlation_threshold: 0.3
  
  # Checkpointing
  checkpoint_dir: './checkpoints'
  save_every: 5  # Save checkpoint every N epochs
  save_best_only: false

# Evaluation
evaluation:
  batch_size: 32
  threshold: 0.5
  compute_confidence_intervals: true
  n_bootstrap: 1000
  confidence_level: 0.95

# Hardware
hardware:
  device: 'cuda'  # cuda or cpu
  num_workers: 4
  pin_memory: true
  use_mixed_precision: true

# Logging
logging:
  log_interval: 10  # Log every N batches
  use_tensorboard: true
  tensorboard_dir: './runs'
  
# Visualization
visualization:
  save_attention_maps: true
  num_examples: 10
  output_dir: './visualizations'

# Reproducibility
random_seed: 42
